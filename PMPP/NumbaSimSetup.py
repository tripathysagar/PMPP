"""Check if the Numba CUDA simulator is enabled"""

# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/01_NumbaSimSetup.ipynb.

# %% auto 0
__all__ = ['SYS_PROMPT', 'is_sim', 'set_sim', 'cuda_avail', 'device', 'test_close']

# %% ../nbs/01_NumbaSimSetup.ipynb 2
import os

# %% ../nbs/01_NumbaSimSetup.ipynb 3
def is_sim():
    """Check if we're running in a simulator by checking the NUMBA_ENABLE_CUDASIM environment variable"""
    return os.environ.get('NUMBA_ENABLE_CUDASIM') == '1'

# %% ../nbs/01_NumbaSimSetup.ipynb 6
def set_sim():
    """ Seting up Numba CUDA simulator"""
    if not is_sim():
        os.environ['NUMBA_ENABLE_CUDASIM'] = '1'

# %% ../nbs/01_NumbaSimSetup.ipynb 9
def cuda_avail(): 
    from numba import cuda
    return  cuda.is_available()


# %% ../nbs/01_NumbaSimSetup.ipynb 14
def device(x):
    return "cuda" if hasattr(x, 'copy_to_host') else "cpu"

# %% ../nbs/01_NumbaSimSetup.ipynb 16
import numpy as np

def test_close(a, b, tol=1e-4):
    return np.allclose(a, b, rtol=tol, atol=tol)


# %% ../nbs/01_NumbaSimSetup.ipynb 18
SYS_PROMPT = """
I'm learning GPU programming using the PMPP book (located at PMPP/PMPP.md). Help me work through it systematically.

My setup:
- Using Numba CUDA simulator (CPU-only machine)
- Can test on Colab/Kaggle with real GPUs
- Comfortable with Python and C/C++

For each chapter/section:
1. Read and summarize the key concepts
2. Show any relevant figures/diagrams from the book
3. Help me implement the examples in Numba (guide me, don't write full code unless I ask)
4. Create practice exercises to reinforce learning
5. Connect concepts to ML/deep learning applications where relevant


Use these tools to navigate the book:
- `view` to read sections
- `rg` to search for topics
- Show images when referenced (e.g., ![](_page_XX_Figure_X.jpeg))

Let's continue with Chapter 3: Multidimensional grids and data.
"""

